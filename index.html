<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VÃ²ng Quay May Máº¯n Premium</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --primary: #e63946; --secondary: #457b9d; --success: #2a9d8f; }
        body { 
            font-family: 'Arial', sans-serif; text-align: center; 
            background: radial-gradient(circle, #1d3557 0%, #000 100%); 
            color: #fff; margin: 0; display: flex; align-items: center; justify-content: center; height: 100vh; overflow: hidden;
        }
        .container { 
            width: 90%; max-width: 850px; background: rgba(255, 255, 255, 0.98); 
            padding: 40px; border-radius: 40px; box-shadow: 0 0 100px rgba(230, 57, 70, 0.3); color: #333;
        }
        h1 { font-size: 3.5rem; color: var(--primary); margin: 0 0 20px 0; text-transform: uppercase; text-shadow: 2px 2px 0 #eee; }
        
        .prize-display { 
            font-size: 9rem; font-weight: 900; margin: 30px 0; height: 220px; line-height: 220px;
            color: var(--secondary); background: #f8f9fa; border: 10px solid #dee2e6; border-radius: 30px;
            transition: all 0.3s;
        }

        button { 
            padding: 25px 80px; font-size: 2.8rem; font-weight: bold; cursor: pointer; 
            background-color: var(--success); color: white; border: none; border-radius: 60px; 
            transition: all 0.1s; box-shadow: 0 12px 0 #1b665d; outline: none;
        }
        button:active { transform: translateY(8px); box-shadow: 0 4px 0 #1b665d; }
        button:disabled { background-color: #bdc3c7; box-shadow: 0 6px 0 #7f8c8d; transform: translateY(4px); }

        .info-panel { display: flex; justify-content: center; gap: 50px; margin-top: 30px; font-size: 1.8rem; font-weight: bold; }
        .count-item span { color: var(--primary); font-size: 2.2rem; }
        
        #mode-indicator { position: fixed; top: 10px; right: 10px; font-size: 10px; color: rgba(255,255,255,0.05); }
    </style>
</head>
<body>

<div id="mode-indicator">Normal</div>
<div class="container">
    <h1>ðŸŽŠ LUCKY DRAW ðŸŽŠ</h1>
    <div class="prize-display" id="result">READY</div>
    <button id="spinBtn" onclick="spin()">QUAY (Space)</button>
    <div class="info-panel">
        <div class="count-item">Giáº£i 50k: <span id="count50">5</span></div>
        <div class="count-item">Giáº£i 20k: <span id="count20">10</span></div>
    </div>
</div>

<audio id="tickSound" src="https://www.soundjay.com/buttons/sounds/button-16.mp3"></audio>
<audio id="winSound" src="https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3"></audio>

<script>
    let inventory = { "50.000": 5, "20.000": 10, "10.000": Infinity };
    let isSpinning = false;
    let cheatMode = false; 

    // Xá»­ lÃ½ PhÃ­m táº¯t
    window.addEventListener('keydown', (e) => {
        if (e.code === "Space" && !isSpinning) spin();
        if (e.key === "5") { 
            cheatMode = true; 
            document.getElementById('mode-indicator').innerText = "Target: 50K";
        }
        if (e.key.toLowerCase() === "c") { 
            cheatMode = false; 
            document.getElementById('mode-indicator').innerText = "Normal"; 
        }
    });

    function spin() {
        if (isSpinning) return;
        const btn = document.getElementById('spinBtn');
        const resultDiv = document.getElementById('result');
        const tick = document.getElementById('tickSound');
        
        isSpinning = true;
        btn.disabled = true;
        resultDiv.style.color = "#457b9d";

        let counter = 0;
        let totalSpins = 120; 

        const interval = setInterval(() => {
            const temp = ["10k", "20k", "50k", "99k", "00k"];
            resultDiv.innerText = temp[Math.floor(Math.random() * temp.length)];
            tick.volume = 0.2;
            tick.currentTime = 0;
            tick.play();

            counter++;
            if (counter > totalSpins) {
                clearInterval(interval);
                finalizeResult();
            }
        }, 30);
    }

    function finalizeResult() {
        const btn = document.getElementById('spinBtn');
        const resultDiv = document.getElementById('result');
        const winSound = document.getElementById('winSound');
        
        let finalPrize = "";

        // Logic Æ°u tiÃªn CheatMode
        if (cheatMode && inventory["50.000"] > 0) {
            finalPrize = "50.000";
            // Tá»° Äá»˜NG RESET SAU KHI DÃ™NG
            cheatMode = false; 
            document.getElementById('mode-indicator').innerText = "Normal";
        } else {
            let pool = [];
            if (inventory["50.000"] > 0) pool.push("50.000");
            if (inventory["20.000"] > 0) pool.push("20.000");
            for(let i=0; i<15; i++) pool.push("10.000"); 
            finalPrize = pool[Math.floor(Math.random() * pool.length)];
        }

        if (inventory[finalPrize] !== Infinity) inventory[finalPrize]--;

        resultDiv.innerText = finalPrize + "Ä‘";
        resultDiv.style.color = "#e63946";
        winSound.play();

        // Hiá»‡u á»©ng phÃ¡o hoa
        if (finalPrize === "50.000") {
            var duration = 3 * 1000;
            var end = Date.now() + duration;
            (function frame() {
                confetti({ particleCount: 7, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#ff0000', '#ffd700'] });
                confetti({ particleCount: 7, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#ff0000', '#ffd700'] });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
        } else {
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        }

        updateUI();
        isSpinning = false;
        btn.disabled = false;
    }

    function updateUI() {
        document.getElementById('count50').innerText = inventory["50.000"];
        document.getElementById('count20').innerText = inventory["20.000"];
    }
</script>

</body>
</html>
